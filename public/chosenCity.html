<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Coding Exercise: Weather</title>

    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  </head>

  <body>
    <div class="jumbotron-container">
      <div class="jumbotron">
        <h1 class="display-4" id="home-jumbo">
          Today's low and high in <span id="chosen-city">Chicago</span> is:
          <span id="low-weather">?</span><span id="high-weather">?</span>
        </h1>

        <hr class="my-4" />
        <div id="form-div">
          <form class="form-inline">
            <input class="form-control" id="searchCityForm" type="text"
              placeholder="Search by Location">
            <button type="submit" id="submitButton" class="btn btn-info mb-2">Press
              First</button>
            <button type="submit" id="getWeather" class="btn btn-info mb-2">Press
              Second</button>
          </form>
        </div>
      </div>

      <script src="jquery.js"></script>
      <script>

      $(document).ready(function () {
        let APIkey = "HgCNJPGZdbENgmsatzFBnhvizNNuayRO"; //To be hidden in .env file
        let searchedCity = "";
        let cityKey = "";

        $("#submitButton").on("click", function SearchCity(event) {
          event.preventDefault();

          searchedCity = $("#searchCityForm").val();
          let searchCityForLink = "http://dataservice.accuweather.com/locations/v1/cities/search?apikey=" + APIkey + "&q=" + searchedCity + "&alias=IL";

          $("#chosen-city").text(searchedCity);

          $.ajax({
            url: searchCityForLink,
            method: "GET"
            }).then(function (response) {
            cityKey = response[0].Key;
            console.log(cityKey)
            })

        })

        $("#getWeather").on("click", function SearchWeather(event){
          event.preventDefault();
          let searchCityForWeather = "http://dataservice.accuweather.com/forecasts/v1/daily/5day/" + cityKey + "?apikey=" + APIkey;

          $.ajax({
            url: searchCityForWeather,
            method: "GET"
            }).then(function (response) {
              console.log(response);
          $("#low-weather").text(response.DailyForecasts[0].Temperature.Minimum.Value + "F & ");
            $("#high-weather").text(response.DailyForecasts[0].Temperature.Maximum.Value + "F");
          })
        })
      })

    </script>
      <script
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous">
      </script>
    </body>

  </html>